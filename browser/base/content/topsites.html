<!DOCTYPE html>
<meta charset=utf-8>
<title>Top sites property usage</title>
<style>
body { font: 14px sans-serif; }
h1 { font-size: 18px; }
iframe { opacity: 0; pointer-events: none; }
.loader { width: 1024px; height: 600px; margin-top: 0.5em; border: 1px solid black; }
.options { background: #ccc; padding: 0.5em; }
textarea, pre { font: 12px monospace; }
textarea { width: 400px; height: 100px; }
.log { overflow: auto; background: #ddd; margin: 0; height: 150px; }
.report { background: #ddd; }
</style>
<body onload="init()">
<h1>Top sites property usage</h1>
<script>
var iframe, iframeStylo, textarea, button, preLog;
var nextIndex = 0;
var timeout;
var styles = new Map();
var siteStyles = [];

function init() {
  if (document.usingStylo) {
    document.setWantsStylo(false);
    window.location.reload();
    return;
  }

  document.setDefaultWantsStylo(false);

  iframe = document.createElement("iframe");
  iframe.className = "loader";
  iframeStylo = document.createElement("iframe");
  iframeStylo.className = "stylo";

  document.body.appendChild(iframe);
  document.body.appendChild(iframeStylo);

  textarea = document.querySelector("textarea");
  button = document.querySelector("button");
  preLog = document.querySelector(".log");
  textarea.value = sites;
  textarea.disabled = false;
  button.disabled = false;
  iframe.src = "";
  iframeStylo.src = "";
  iframeStylo.contentDocument.setWantsStylo(true);
}

function go() {
  if (iframe.contentDocument.usingStylo) {
    alert("error: could not force site loading iframe to not use stylo");
    return;
  }

  if (!iframeStylo.contentDocument.usingStylo) {
    alert("error: could not force secondary iframe to use stylo");
    return;
  }

  sites = textarea.value.trim().split("\n").map(s => !s.startsWith("http:") && !s.startsWith("https:") ? "http://" + s : s);
  textarea.value = sites.join("\n");
  textarea.disabled = true;
  button.disabled = true;
  iframe.style.opacity = "0.5";
  iframe.onload = loaded;
  next();
}

function log(s) {
  preLog.textContent += s + "\n";
  preLog.scrollTop = preLog.scrollHeight;
}

function next() {
  if (nextIndex >= sites.length) {
    report();
    return;
  }
  log(`[${nextIndex + 1}/${sites.length}] ${sites[nextIndex]}`);
  document.title = `[${nextIndex + 1}/${sites.length}] Top sites property usage`;
  iframe.src = sites[nextIndex];
  ++nextIndex;
  timeout = setTimeout(function() {
    iframe.contentWindow.stop();
    log("  (timed out)");
    loaded();
  }, 10000);
}

function analyze() {
  var handled = new Set();
  var thisStyles = new Map();
  siteStyles.push({ site: iframe.src, styles: thisStyles });

  iframe.contentDocument.gatherStyles().forEach(function(entry) {

    var { property: p, value: v } = entry;

    // Skip properties and values that are supported in Servo.
    if (iframeStylo.contentWindow.CSS.supports(p, v)) {
      return;
    }

    // Skip "initial" and "inherit".
    if (v == "initial" || v == "inherit") {
      return;
    }

    // Skip -moz-binding, which is incorrectly reported as not supported.
    if (p == "-moz-binding") {
      return;
    }

    // Collapse length and percentage values.
    v = v.replace(/-?[0-9.]+(%|[a-z]+)/g, () => "1" + RegExp.$1);

    // Collapse rgb() values.
    v = v.replace(/rgb\([0-9]+, [0-9]+, [0-9]+\)/g, "rgb(...)");

    // Collapse rgba() values.
    v = v.replace(/rgba\([0-9]+, [0-9]+, [0-9]+, [0-9.]+\)/g, "rgba(...)");

    // Collapse url() values.
    v = v.replace(/url\("(.*\\")*.*"\)/g, "url(...)");

    // Collapse integer values.
    v = v.replace(/^[0-9]+$/, "1");

    // Collapse number values.
    v = v.replace(/^([0-9]*\.[0-9]+|[0-9]+\.[0-9]*)$/, "1");

    // Collapse colour keyword values.
    v = v.replace(/\b(black|silver|gray|white|maroon|red|purple|fuchsia|green|lime|olive|yellow|navy|blue|teal|aqua|aliceblue|antiquewhite|aqua|aquamarine|azure|beige|bisque|black|blanchedalmond|blue|blueviolet|brown|burlywood|cadetblue|chartreuse|chocolate|coral|cornflowerblue|cornsilk|crimson|cyan|darkblue|darkcyan|darkgoldenrod|darkgray|darkgreen|darkgrey|darkkhaki|darkmagenta|darkolivegreen|darkorange|darkorchid|darkred|darksalmon|darkseagreen|darkslateblue|darkslategray|darkslategrey|darkturquoise|darkviolet|deeppink|deepskyblue|dimgray|dimgrey|dodgerblue|firebrick|floralwhite|forestgreen|fuchsia|gainsboro|ghostwhite|gold|goldenrod|gray|green|greenyellow|grey|honeydew|hotpink|indianred|indigo|ivory|khaki|lavender|lavenderblush|lawngreen|lemonchiffon|lightblue|lightcoral|lightcyan|lightgoldenrodyellow|lightgray|lightgreen|lightgrey|lightpink|lightsalmon|lightseagreen|lightskyblue|lightslategray|lightslategrey|lightsteelblue|lightyellow|lime|limegreen|linen|magenta|maroon|mediumaquamarine|mediumblue|mediumorchid|mediumpurple|mediumseagreen|mediumslateblue|mediumspringgreen|mediumturquoise|mediumvioletred|midnightblue|mintcream|mistyrose|moccasin|navajowhite|navy|oldlace|olive|olivedrab|orange|orangered|orchid|palegoldenrod|palegreen|paleturquoise|palevioletred|papayawhip|peachpuff|peru|pink|plum|powderblue|purple|red|rosybrown|royalblue|saddlebrown|salmon|sandybrown|seagreen|seashell|sienna|silver|skyblue|slateblue|slategray|slategrey|snow|springgreen|steelblue|tan|teal|thistle|tomato|turquoise|violet|wheat|white|whitesmoke|yellow|yellowgreen)\b/g, "black");

    // Collapse -moz-linear-gradient() values.
    v = v.replace(/-moz-linear-gradient\(.*\)/g, "-moz-linear-gradient(...)");

    // Collapse linear-gradient() values.
    v = v.replace(/linear-gradient\(.*\)/g, "linear-gradient(...)");

    // Collapse radial-gradient() values.
    v = v.replace(/radial-gradient\(.*\)/g, "radial-gradient(...)");

    // Collapse attr() values.
    v = v.replace(/attr\(.*\)/g, "attr(...)");

    // Collapse -x-lang, transition-property, animation-name, will-change and font-feature-settings values.
    if (p == "-x-lang" ||
        p == "transition-property" ||
        p == "animation-name" ||
        p == "will-change" ||
        p == "font-feature-settings") {
      v = "xx";
    }

    if (!thisStyles.has(p)) thisStyles.set(p, new Set());
    thisStyles.get(p).add(v);

    if (handled.has(p + ":" + v)) return;
    handled.add(p + ":" + v);

    if (!styles.has(p)) styles.set(p, new Map());
    if (!styles.get(p).has(v)) styles.get(p).set(v, 0);
    styles.get(p).set(v, styles.get(p).get(v) + 1);
  });
}

function loaded() {
  clearTimeout(timeout);
  timeout = undefined;
  setTimeout(function() {
    analyze();
    next();
  }, 1000);
}

function report() {
  function entry_cmp(a, b) {
    if (a.count > b.count) return 0;
    if (a.count < b.count) return 1;
    if (a.property > b.property) return 0;
    if (a.property < b.property) return 1;
    if (a.value > b.value) return 0;
    if (a.value < b.value) return 1;
    return 0;
  }

  document.title = `[done] Top sites property usage`;

  iframe.remove();
  iframeStylo.remove();

  var entries = [];

  styles.forEach(function(vs, p) {
    vs.forEach(function(n, v) {
      entries.push({ property: p, value: v, count: n });
    });
  });

  entries.sort(entry_cmp);

  var message = "# Summary for all sites\n\n" +
    entries.map(e => `(${e.count}) ${e.property}: ${e.value}`).join("\n");

  siteStyles.forEach(function(entry) {
    message += "\n\n# " + entry.site + "\n\n";

    var entries = [];
    entry.styles.forEach(function(vs, p) {
      vs.forEach(function(v) {
        entries.push({ property: p, value: v });
      });
    });

    entries.sort(entry_cmp);
    message += entries.map(e => `${e.property}: ${e.value}`).join("\n");
  });

  document.querySelector(".report").textContent = message;
}
</script>
<div class="options">
  <div style="float: left; padding-right: 1em;">
    <div>Sites to analyze:</div>
    <div><textarea></textarea></div>
    <div><button onclick="go()">Go</button></div>
  </div>
  <pre class="log"></pre>
</div>
<script>
var sites = `

https://www.google.com/search?q=flowers
https://www.facebook.com/cnn
www.youtube.com/
https://www.yahoo.com/
www.baidu.com/s?wd=%E8%8A%B1%E5%8D%89
en.wikipedia.org/wiki/Google
https://twitter.com/hashtag/news
www.qq.com/
www.taobao.com/
www.amazon.com/
www.linkedin.com/in/reidhoffman
www.sina.com.cn/
us.weibo.com/gb
www.hao123.com/
googleblog.blogspot.com/
www.tmall.com/
www.sohu.com/
yandex.ru/yandsearch?text=%D1%86%D0%B2%D0%B5%D1%82%D1%8B
www.bing.com/search?q=flowers
dailypost.wordpress.com/
www.pinterest.com/topgroupboards/pins/
www.ebay.com/sch/i.html?_nkw=toys
instagram.com/cnn
www.msn.com/
www.ask.com/web?q=flowers
www.163.com/
all-thats-interesting.tumblr.com/
https://mail.ru/
www.microsoft.com/
www.xvideos.com/
stackoverflow.com/questions/24848359/which-is-faster-while1-or-while2
www.imdb.com/
www.apple.com/
imgur.com/
www.reddit.com/
washingtondc.craigslist.org/search/sss?query=flowers
xhamster.com/
www.aliexpress.com/
www.bbc.com/news/uk/
espn.go.com/
abcnews.go.com/
www.cnn.com/
wordpress.org/
people.com.cn/
www.godaddy.com/
www.gmw.cn/
xinhuanet.com/
www.ifeng.com/
www.alibaba.com/
www.huffingtonpost.com/
www.pornhub.com/
vube.com/
www.adobe.com/
themeforest.net/popular_item/by_category?category=wordpress
cn.chinadaily.com.cn/
www.dailymotion.com/us
https://www.dropbox.com/
www.dailymail.co.uk/home/index.html
www.booking.com/city/us/philadelphia.en-us.html
search.about.com/?q=flowers
www.uol.com.br/
vimeo.com/channels/staffpicks
www.rakuten.co.jp/
www.indiatimes.com/
www.xnxx.com/
https://www.flickr.com/explore/
https://www.alipay.com/
www.flipkart.com/
www.globo.com/
www.redtube.com/
www.buzzfeed.com/
www.tudou.com/
www.fiverr.com/
www.nytimes.com/
www.pixnet.net/
www.pconline.com.cn/
www.cnet.com/
www.aol.com/
wenwen.sogou.com/
www.yelp.com/search?find_desc=dinner&find_loc=New+York%2C+NY&ns=1
ameblo.jp/
https://github.com/WPO-Foundation/webpagetest
new.livejasmin.com/en/
www.slideshare.net/patrickmeenan
www.w3schools.com/html/default.asp
www.theguardian.com/uk
www.so.com/s?q=%E8%8A%B1%E5%8D%89
https://www.mozilla.org/en-US/firefox/desktop/
www.weather.com/weather/today/The+Walt+Disney+World+Resort+FL+USFL0615:1:US
tw.gigacircle.com/
www.wikia.com/Wikia
www.forbes.com/home_usa/
https://www.gmail.com/
ursulav.livejournal.com/
www.zol.com.cn/
www.salesforce.com/
www.wikihow.com/Jump-Start-a-Car
www.spiegel.de/
www.livedoor.com/
www.deviantart.com/
https://www.bankofamerica.com/
www.ettoday.net/
wordpress.stackexchange.com/questions/40430/how-to-have-wordpress-send-a-user-confirmation-validation-email-on-signup
https://www.chase.com/
www.businessinsider.com/
www.fifa.com/
www.aili.com/
9gag.com/
news.blogfa.com/
www.indeed.com/jobs?q=software+engineer&l=mountain+view%2C+ca
www.zillow.com/homes/Palo-alto-ca_rb/
https://soundcloud.com/
www.yaolan.com/
www.mama.cn/
www.mmbang.com/
www.hostgator.com/
www.walmart.com/
www.foxnews.com/
www.tripadvisor.com/
mashable.com/
www.shutterstock.com/cat.mhtml?searchterm=flowers
sourceforge.net/projects/tortoisesvn/
www.skype.com/
baomihua.com/
www.addthis.com/
badoo.com/
dictionary.reference.com/browse/Pneumonoultramicroscopicsilicovolcanoconiosis
https://web.archive.org/web/*/google.com
www.bet365.com/en/
www.bild.de/
www.naver.com/
rt.com/
https://www.wellsfargo.com/
www.answers.com/topic/flower
https://www.etsy.com/
www.onet.pl/
bleacherreport.com/
www.jabong.com/women/
allegro.pl/
www.wordreference.com/definition/flowers
www.wix.com/
www.avg.com/us-en/homepage
codecanyon.net/category/php-scripts
www.nicovideo.jp/
us2.php.net/manual/en/function.urlencode.php
www.ikea.com/us/en/
www.goo.ne.jp/
www.ups.com/?Site=Corporate&cookie=us_en_home&inputImgTag=
www.warriorforum.com/main-internet-marketing-discussion-forum/
www.tube8.com/
www.espncricinfo.com/
www.pchome.net/
online.wsj.com/home-page
www.pandora.com/music/pop/todays-hits
www.gome.com.cn/
www.washingtonpost.com/
us.gameforge.com/
chinaz.com/
www.snapdeal.com/
www.enet.com.cn/
www.quora.com/Flowers
photobucket.com/popular/images
www.hurriyet.com.tr/anasayfa/
www.goodreads.com/genres/science-fiction
huanqiu.com/
www.marca.com/
en.softonic.com/
beijing.bitauto.com/
www.b5m.com/
www.wp.pl/
carros.mercadolivre.com.br/#D[H:true]
www.xywy.com/
www.usatoday.com/
www.kompas.com/
www.reuters.com/
www.kaskus.co.id/
java.com/en/
https://www.usps.com/
www.ci123.com/
www.gmx.net/
www.ndtv.com/
www.comcast.com/
www.rediff.com/
www.myntra.com/
www.meetup.com/Web-Performance-NY/
feedly.com/#subscription%2Ffeed%2Fhttp%3A%2F%2Fwww.theverge.com%2Frss%2Ffull.xml
www.detik.com/
www.jrj.com.cn/
www.rambler.ru/
www.xgo.com.cn/
techcrunch.com/
www.douban.com/
www.fedex.com/us/
www.ehow.com/
www.varzesh3.com/
www.samsung.com/us/
www.scribd.com/browse/Books
www.bluehost.com/
www.hp.com/
www.repubblica.it/
www.webmd.com/
www.tianya.cn/
whois.domaintools.com/google.com
www.gsmarena.com/
time.com/
www.milliyet.com.tr/
www.ign.com/
www.taringa.net/
www.constantcontact.com/
lifehacker.com/
www.yesky.com/
icicibank.com/
https://www.americanexpress.com/
rbc.ru/
https://chaturbate.com/
nih.gov/
web.de/
www.target.com/
www.bestbuy.com/
bangalore.olx.in/vehicles-cat-362
www.pcbaby.com.cn/
https://www.odesk.com/o/profiles/browse/?q=web+designer
elpais.com/elpais/portada_america.html
https://www.elance.com/r/contractors/ind-true/cat-it-programming/q-website%20design
www.tmz.com/
www.daum.net/
www.abril.com.br/
www.elmundo.es/
www.bloomberg.com/
www.free.fr/
www.baike.com/
www.clickbank.com/
https://www.xing.com/profile/Lars_Hinrichs
www.accuweather.com/en/us/disney-world-fl/32830/weather-forecast/69031_poi
gizmodo.com/
www.homedepot.com/
www.thefreedictionary.com/flower
lenta.ru/
www.sahibinden.com/
www.orange.fr/
www.lemonde.fr/
https://www.capitalone.com/
evernote.com/
kakaku.com/
mlb.mlb.com/home
www.kooora.com/
www.libero.it/?
www.youjizz.com/
www.hulu.com/
steamcommunity.com/
jqw.com/
sabq.org/
www.mbc.net/ar.html
www.engadget.com/
motherless.com/
https://www.surveymonkey.com/
issuu.com/
www.dell.com/
www.trulia.com/for_sale/Palo_Alto,CA
www.naukri.com/
www.pof.com/
www.gazeta.pl/
https://www.onlinesbi.com/
privatehomeclips.com/
www.rednet.cn/
store.steampowered.com/
beeg.com/
www.intuit.com/
indiatoday.intoday.in/
xuite.net/
likes.com/
subscene.com/
www.expedia.com/
www.nbcnews.com/
youm7.com/
drudgereport.com/
www.t-online.de/
17ok.com/
www.goodgamestudios.com/
www.corriere.it/
www.seznam.cz/
www.hotels.com/
www.retailmenot.com/
www.istockphoto.com/stock-photos
www.oracle.com/
www.independent.co.uk/
www.onlylady.com/
bongacams.com/
https://www.kickstarter.com/discover/popular
lenovo.com/us/en/
www.att.com/
www.w3.org/
www.joomla.org/
www.xda-developers.com/
www.nydailynews.com/
www.51fanli.com/
www.in.com/
www.newegg.com/
www.sberbank.ru/moscow/ru/person/
ria.ru/
www.hatena.ne.jp/
www.mirror.co.uk/
www.4399.com/
www.chexun.com/
www.latimes.com/
www.blackhatworld.com/
www.youth.cn/
www.adultpornvideox.com/
www.semrush.com/?db=us
www.houzz.com/
https://www.irctc.co.in/
lockerdome.com/
us.asos.com/
us.fotolia.com/Info/Photos/BestSellers
digg.com/
www.kinopoisk.ru/
www.theladbible.com/
motos.mercadolibre.com.ar/accesorios/
kwejk.pl/
www.urbandictionary.com/
us.battle.net/en/
https://www.freelancer.com/
ck101.com/
diply.com/
www.voc.com.cn/
www.rottentomatoes.com/
stockstar.com/
jquery.com/
shop.nordstrom.com/
www.kijiji.ca/b-cars-trucks/banff-canmore/c174l1700234
https://online.citibank.com/US/Welcome.c
www.bloglovin.com/
www.bodybuilding.com/
https://trello.com/b/nC8QJJoZ/trello-development
9gag.tv/
www.timeanddate.com/
thefreecamsecret.com/
www.commentcamarche.net/
www.hupu.com/
www.vice.com/en_us
www.2345.com/
www.chip.de/
www.moneycontrol.com/
www.pcgames.com.cn/
www.nba.com/
sanjose.backpage.com/AutoPartsForSale/
www.kayak.com/New-York-Hotels.15830.hotel.ksp
news.zing.vn/
www.almasryalyoum.com/
www.cntv.cn/index.shtml
www.marketwatch.com/
www.shopify.com/online
www.lequipe.fr/
www.priceline.com/cheap-hotels-kissimmee-florida-FL-tk-c288080-hl.hotel-reviews-hotel-guides
ce.cn/
www.liveleak.com/
www.lanacion.com.ar/
www.myfreecams.com/#Homepage
https://foursquare.com/
www.verizonwireless.com/
www.glassdoor.com/index.htm
www.chinatimes.com/
who.is/whois/google.com
www.hardsextube.com/
www.focus.de/
www.entrepreneur.com/
www.123rf.com/stock-photo/
www.pog.com/
www.azlyrics.com/
www.it168.com/
usagc.org/
www.upworthy.com/
www.tukif.com/
tabelog.com/
www.ixxx.com/
eastday.com/
blog.seesaa.jp/
www.eonline.com/
www.agoda.com/
www.clarin.com/
vnexpress.net/
as.com/
hubpages.com/
www.mobile.de/
www.npr.org/
www.slate.com/
www.theverge.com/
allrecipes.com/
www.theblaze.com/
www.shaadi.com/
www.southwest.com/
www.realtor.com/realestateandhomes-search/Palo-Alto_CA
https://www.spotify.com/us/
kdnet.net/
www.verizon.com/?lid=//global//residential
www.givemesport.com/
slickdeals.net/
cbslocal.com/
getbootstrap.com/
tutsplus.com/
www.bhaskar.com/
www.app111.com/
www.monster.com/
www.wunderground.com/q/zmw:32801.1.99999
www.csdn.net/
superuser.com/
www.terra.com.br/
www.vesti.ru/
www.eventbrite.com/
www.templatemonster.com/wordpress-themes.php
www.howstuffworks.com/
www.ileehoo.com/
www.macys.com/
www.coupons.com/
gawker.com/
www.cnbc.com/
www.news.com.au/
www.dreamstime.com/
www.overstock.com/
www.infobae.com/?noredirect
www.workercn.cn/
www.lowes.com/
wetter.com/
www.hunantv.com/
www.gamefaqs.com/
www.cbssports.com/
www.iflscience.com/
sakura.ne.jp/
torchbrowser.com/
www.jd.com/
www.welt.de/
css-tricks.com/
www.foxsports.com/
www.babytree.com/
www.wired.com/
www.etao.com/
www.sears.com/
www.iminent.com/
www.babycenter.com/
www.pcmag.com/
www.aparat.com/
www.hespress.com/
zovi.com/
www.gazeta.ru/
premium.wpmudev.org/projects/tag/wordpress-seo/
https://www.behance.net/
www.mapquest.com/
www.smh.com.au/
www.oneindia.in/
www.ltn.com.tw/
www.dmm.com/
www.sfgate.com/
www.yoka.com/
www.haber7.com/
www.android.com/
www.ynet.co.il/
graphicriver.net/
www.people.com/people/
www.chron.com/
www.rightmove.co.uk/
www.petflow.com/
searchengines.guru/
pixlr.com/
www.viralnova.com/
www.businessweek.com/
www.zappos.com/
https://www.airbnb.com/
www.bhphotovideo.com/
www.starbaby.cn/
www.pixiv.net/
www.mynet.com/
www.sex.com/
www.prestashop.com/
www.elegantthemes.com/gallery/
www.shopclues.com/
www.interia.pl/
na.leagueoflegends.com/
www.cracked.com/
www.foodnetwork.com/
www.nike.com/us/en_us/
www.zulily.com/
www.examiner.com/
www.cbc.ca/
searchengineland.com/
www.staples.com/
www.kohls.com/
www.united.com/
www.ted.com/
www.nbcsports.com/
www.fool.com/
https://duckduckgo.com/?q=flowers
https://www.change.org/
www.skysports.com/
www.ticketmaster.com/
www.today.com/
www.thedailybeast.com/
500px.com/popular
nypost.com/
boards.4chan.org/g/
www.noaa.gov/
www.gamespot.com/
www.cbsnews.com/
www.costco.com/

`.trim();
</script>
<pre class="report"></pre>
